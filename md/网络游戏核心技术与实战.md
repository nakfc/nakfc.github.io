
# RPC(Remote Procedure Call:远程过程调用协议)
    定义一个服务， 指定其可以被远程调用的方法及其参数和返回类型

![网络游戏使用的RPC模式图.png](https://i.loli.net/2019/07/09/5d2371326803b52124.png)

# RPC Stub（存根代码:使用RPC工具自动生成)

# IDL(Interface Description Language:接口 定义/描述 语言) 
    让服务端与客户端进行对话，如:gRPC使用Protocol Buffers
# gRPC

# Unity 中使用 gRPC
Unity
gRPC C# now has experimental support for Unity. Please try using gRPC with Unity and provide feedback!

How to test gRPC in a Unity project

Create a Unity project that targets .NET 4.x (Edit -> Project Settings -> Editor -> Scripting Runtime Version). gRPC uses APIs that are only available in .NET4.5+ so this is a requirement.

* Download the latest development build of grpc_unity_package.VERSION.zip from daily builds

* Extract the .zip file in the Assets directory in your Unity project

* Unity IDE will pick up all the bundled files and add them to project automatically. You should be able to use gRPC and Protobuf in your scripts from now on.

What's currently bundled in the grpc_unity_package

Grpc.Core and its dependencies
Google.Protobuf
Precompiled native libraries for Linux, MacOS, Windows, Android and iOS.


    |   目标编程语言    |    调用侧               | IDL(Protocol Buffers)      |  Stub  | 
    |   --------       |    --------            | -------------              | --------|
    |   lua            |    test.lua            | 100---Login.proto          |   100---Login_pb.lua    |
    |   csharp         |    Program.cs                | helloworld.proto                         |   Helloworld.cs    |
    |   erlang         |    草莓                | $1                         |   7    |


# C# 中使用 gRPC
* 依赖包：**Grpc** & **Grpc.Tools** & **Google.Protobuf**

[Hello World 示例项目地址](https://github.com/grpc/grpc/tree/master/examples/csharp/Helloworld)

## 构建
0. 需要 protoc & protobuf C#插件的二进制版本(在包 Grpc.Tools 中已经包含)
> The **Grpc.Tools** NuGet package contains the protoc and protobuf C# plugin binaries needed to generate the code. 

1. (所以)使用cmd或者vs2017生成即可
        dotnet build Greeter.sln

> This example project already **depends on** the **Grpc.Tools.1.22.0** NuGet package so just **re-building** the solution is enough to regenerate the code from our modified .proto file.

构建以后生成的文件
> grpc-master\examples\csharp\Helloworld\Greeter\obj\Debug\netstandard1.5

The build regenerates the following files under the Greeter/obj/Debug/TARGET_FRAMEWORK directory:

* **Helloworld.cs**(Stub)  contains all the protocol buffer code to populate, serialize, and retrieve our request and response message types

* HelloworldGrpc.cs provides generated client and server classes, including:
> * an abstract class **Greeter.GreeterBase** (由服务端所使用) to inherit from when defining Greeter service implementations
> * a class **Greeter.GreeterClient** (由客户端所使用)that can be used to access remote Greeter instances

## 运行

> 假设当前目录：grpc-master\examples\csharp\Helloworld

运行方式1：run app

    // Server
    cd .\GreeterServer
    dotnet run -f netcoreapp2.1

    // Client
    cd .\GreeterServer
    dotnet run -f netcoreapp2.1

运行方式2：exec dll

    // 服务端
    dotnet exec .\GreeterServer\bin\Debug\netcoreapp2.1\GreeterServer.dll

    // 客户端
    dotnet exec .\GreeterServer\bin\Debug\netcoreapp2.1\GreeterClient.dll
